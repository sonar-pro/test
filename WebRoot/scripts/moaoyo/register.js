(function(d){if(typeof d.mk=="undefined"){d.mk={}}if(typeof d.mk.register=="undefined"){d.mk.register={}}var h,g,f,c,a="F";var b;var e=/\b(^[_a-zA-Z0-9-]+(\.[_a-zA-Z0-9-]+)*@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)*$)\b/;d.mk.register.checkNickName=function(i){var j=d.trim(i.value);if(j.length<2){d("#input_nickname").show();d("#input_nickname_s").html("昵称长度需两个字符以上");d("#input_nickname").attr("class","reg-check-tip wrong");h="F";return false}if(!d.mk.syset.checkNickNameFuHao(j)){d("#input_nickname").show();d("#input_nickname_s").html("含有特殊字符！");d("#input_nickname").attr("class","reg-check-tip wrong");h="F";return false}d.ajax({url:"/register|checkIsForbid.action",type:"get",data:{nickName:j},success:function(k){d("#input_nickname").show();if(k=="register.error.nickName"){d("#input_nickname_s").html("含有违禁符号或汉字");d("#input_nickname").attr("class","reg-check-tip wrong");h="F"}else{if(k=="register.check.nickName"){d("#input_nickname_s").html("此昵称太受欢迎了，换一个试试。");d("#input_nickname").attr("class","reg-check-tip wrong");h="F"}else{d("#input_nickname").attr("class","reg-check-tip ok");h="T"}}}})};d.mk.register.focusNickName=function(i){d("#input_nickname").show()};d.mk.register.checkNickNameFast=function(i){var j=d.trim(i.value);if(j.length<2){d("#input_nickname").attr("class","reg-check-tip warning");h="F";return false}if(!d.mk.syset.checkNickNameFuHao(j)){d("#input_nickname").attr("class","reg-check-tip warning");h="F";return false}d.ajax({url:"/register|checkIsForbid.action",type:"get",data:{nickName:j},success:function(k){if(k=="register.error.nickName"){d("#input_nickname").attr("class","reg-check-tip warning");h="F"}else{if(k=="register.check.nickName"){d("#input_nickname").attr("class","reg-check-tip warning");h="F"}else{d("#input_nickname").attr("class","reg-check-tip ok");h="T"}}}})};d.mk.register.focusEmail=function(i){d("#input_email").show()};d.mk.register.checkEmailFast=function(j){var i=d.trim(j.value);if(i.length<=0){d("#input_email").attr("class","reg-check-tip warning");g="F";return false}else{if(!e.test(i)){d("#input_email").attr("class","reg-check-tip warning");g="F";return false}}d.ajax({url:"/register|checkEmailIsUse.action",type:"get",data:d.param({email:i}),success:function(k){if(k=="register.error.email"){d("#input_email").attr("class","reg-check-tip warning");g="F"}else{d("#input_email").attr("class","reg-check-tip ok");g="T"}}})};d.mk.register.checkPasswordFast=function(j){var i=d.trim(j.value);if(i.length==0){d("#input_password").attr("class","reg-check-tip warning");f="F"}else{if(i.indexOf(" ")!=-1){d("#input_password").attr("class","reg-check-tip warning");f="F"}else{if((i.length<6)||(i.length>24)){d("#input_password").attr("class","reg-check-tip warning");f="F"}else{d("#input_password").attr("class","reg-check-tip ok");f="T"}}}};d.mk.register.checkEmail=function(j){var i=d.trim(j.value);if(!_checkEmailIsIllegal(i)){return}d.ajax({url:"/register|checkEmailIsUse.action",type:"get",data:d.param({email:i}),success:function(k){d("#input_email").show();if(k=="register.error.email"){d("#input_email_s").html("该登陆邮箱格式不对或已使用");d("#input_email").attr("class","reg-check-tip wrong");g="F"}else{d("#input_email").attr("class","reg-check-tip ok");g="T"}}})};d.mk.register.showStrengthDiv=function(){d("#input_password_s").show();d("#input_password_s2").hide()};d.mk.register.checkPw=function(j){var i=d.trim(j.value);d("#input_password").show();if(i.length==0){d("#input_password_s").hide();d("#input_password_s2").html("请输入密码").show();d("#input_password").attr("class","reg-check-tip wrong");f="F"}else{if(i.indexOf(" ")!=-1){d("#input_password_s").hide();d("#input_password_s2").html("密码不能有违禁字符").show();d("#input_password").attr("class","reg-check-tip wrong");f="F"}else{if((i.length<6)||(i.length>24)){d("#input_password_s").hide();d("#input_password_s2").html("密码长度6到24位").show();d("#input_password").attr("class","reg-check-tip wrong");f="F"}else{d("#input_password_s").hide();d("#input_password_s2").hide();d("#input_password").attr("class","reg-check-tip ok");f="T"}}}};d.mk.register.focusPassword=function(i){d("#input_password").show();d("#input_password").attr("class","reg-check-tip");d.mk.register.showStrengthDiv()};d.mk.register.focusConfirmPwd=function(i){d("#input_passwordConfirm").show()};d.mk.register.confirmPw=function(k){var i=d.trim(d("#password").val());var j=k.value;if((i.length<6)||(i.length>24)){d("#input_password_s").hide();d("#input_password_s2").html("密码长度6到24位").show();d("#input_password").show();d("#input_password").attr("class","reg-check-tip wrong");c="F"}else{if(j!=i){d("#error_comfirm").html("两次输入的密码不一样,请重新输入!");d("#input_passwordConfirm").show();d("#input_passwordConfirm").attr("class","reg-check-tip wrong");c="F"}else{d("#input_passwordConfirm").show();d("#input_passwordConfirm").attr("class","reg-check-tip ok");c="T"}}};d.mk.register.changeVerifyCode=function(){d("#verifyImage").attr("src","/kaptcha.jpg?randomp="+Math.random());d("#verifyCode").val("");d("#input_verifycode").hide()};d.mk.register.checkVerifyCode=function(j){var i=d.trim(j.value);if(i==""){d("#verifycodeErrorMsg").html("请输入验证码");d("#input_verifycode").attr("class","reg-check-tip wrong");d("#input_verifycode").show()}else{d("#input_verifycode").attr("class","reg-check-tip ok");d("#input_verifycode").show()}};d.mk.register.saveRegisterFirst=function(){if(d.trim(d("#nickName").val())==""||h=="F"){var j=d.param({content:"请按要求输入昵称。"});d.mokoDialog({url:"/jsps/register/RegisterTiShiPop.jsp?"+j});return false}if(d.trim(d("#email").val())==""||g=="F"){var j=d.param({content:"请按要求输入登陆邮箱。"});d.mokoDialog({url:"/jsps/register/RegisterTiShiPop.jsp?"+j});return false}if(d.trim(d("#password").val())==""||f=="F"){var j=d.param({content:"请按要求输入密码。"});d.mokoDialog({url:"/jsps/register/RegisterTiShiPop.jsp?"+j});return false}if(d.trim(d("#passwordConfirm").val())!=d.trim(d("#password").val())){var j=d.param({content:"请按要求输入确认密码。"});d.mokoDialog({url:"/jsps/register/RegisterTiShiPop.jsp?"+j});return false}if(d.trim(d("#verifyCode").val())==""){var j=d.param({content:"请输入验证码。"});d.mokoDialog({url:"/jsps/register/RegisterTiShiPop.jsp?"+j});return false}if(!d("#input_isCheck").prop("checked")){var j=d.param({content:"请先阅读并同意<美空网服务条款>。"});d.mokoDialog({url:"/jsps/register/RegisterTiShiPop.jsp?"+j});return false}else{var k="REGISTER_NUM";var i=_checkCookie(k);if(i>2){var j=d.param({content:"这台电脑已经注册太多账号,过段时间再注册!"});d.mokoDialog({url:"/jsps/register/RegisterTiShiPop.jsp?"+j});return false}if(!_validateVerifyCode(d("#verifyCode").val())){return false}d("#btnRegisterSave").attr("disabled",false);_checkIp(k,i,"fmRegisterFirst");d("#btnRegisterSave").attr("disabled",true)}};d.mk.register.saveFastRegister=function(){if(d.trim(d("#nickName").val())==""||h=="F"){var j=d.param({content:"请按要求输入昵称。"});d.mokoDialog({url:"/jsps/register/RegisterTiShiPop.jsp?"+j});return false}if(d.trim(d("#email").val())==""||g=="F"){var j=d.param({content:"请按要求输入登陆邮箱。"});d.mokoDialog({url:"/jsps/register/RegisterTiShiPop.jsp?"+j});return false}if(d.trim(d("#password").val())==""||f=="F"){var j=d.param({content:"请按要求输入密码。"});d.mokoDialog({url:"/jsps/register/RegisterTiShiPop.jsp?"+j});return false}var k="REGISTER_NUM";var i=_checkCookie(k);if(i>2){var j=d.param({content:"这台电脑已经注册太多账号,过段时间再注册!"});d.mokoDialog({url:"/jsps/register/RegisterTiShiPop.jsp?"+j});return false}_checkIp(k,i,"fmFastRegister")};_checkCookie=function(k){var i=d.getCookie(k);var j=1;if(i==""){d.setCookie(k,1,1)}else{var j=parseInt(i)}return j};_checkIp=function(k,i,j){d.ajax({url:"/register|checkRegisterNumAjax.action",type:"post",success:function(l){if(l=="dataErr"){var m=d.param({content:"此IP已经注册太多账号,过段时间再注册!"});d.mokoDialog({url:"/jsps/register/RegisterTiShiPop.jsp?"+m});return false}else{d.setCookie(k,i+1,1);d("#"+j).submit()}}})};d.mk.register.unSaveAndBack=function(){d.location(document.referrer)};d.mk.register.checkVocationList=function(){if(d(".current-job .current-jobBox input:checkbox").size()==0){_vocationCountAlert("请选择职业！");return}if(d(".current-job .current-jobBox input:checkbox").size()>3){_vocationCountAlert("你最多只能选择3个职业！");return}if(d(".current-job .current-jobBox:first .current-null").size()>0){var i=d(".current-job .current-jobBox a:first").text();_vocationCountAlert('<span class="mC">'+i+"</span> 将变为你的主要职业，<br />是否确定保存？","confirm")}else{d.mk.register.saveVocationList()}};d.mk.register.saveVocationList=function(){d.ajax({url:"/editUserVocation|ajaxEdit.action",type:"post",data:d("#EditVocation").serialize(),success:function(i){_saveVocationListCallBack(i)}})};d.mk.register.selectVocation=function(i){var j=d("#chooseVocation_"+i);if(j.hasClass("alive")){j.removeClass("alive");_delVocation(i)}else{if(d(".current-job .current-jobBox input:checkbox").size()>=3){_vocationCountAlert("你最多只能选择3个职业！");return}j.addClass("alive");_addVocation(i)}};_vocationCountAlert=function(j,i){var k=d.param({content:j,type:i});d.mokoDialog({url:"/jsps/register/RegisterTiShiPop.jsp?"+k})};_addVocation=function(j){var n=d("#vocation_box_"+j);var m=n.find("a").text();var k=n.find("img").attr("src")||n.find("img").attr("src2");var l='<div class="current-jobBox">						<img title="" src="">						<a href="javascript:void(0);" title="" hidefocus="true">&nbsp;</a>						<input type="button" class="btn" value="删除">						<input type="checkbox" name="vocations" value="" checked="checked" style="display: none" />					</div>';var i=d(l).attr("id","current_job_"+j);i.find("img").attr({title:m,src:k});i.find("a").attr("title",m).text(m);i.find("input:button").bind("click",{boxId:j},function(o){n.find("a").removeClass("alive");_delVocation(o.data.boxId)});i.find("input:checkbox").val(j);d(".current-job .current-jobBox .current-null:first").parent().replaceWith(i)};_delVocation=function(i){d("#current_job_"+i).html('<div class="current-null">未选择</div>')};d.mk.register.updateLoginEmail=function(){if(d("#resultInfo_p").size()!=0){d("#resultInfo_p").remove()}var j=d.trim(d("#email").val());if(j==""){d("#currentEmail").after('<p class="borderOn lesserColor lineheight30 pBackColor_1" id="resultInfo_p">请输入登录邮箱!</p>');return false}if(!e.test(j)){d("#currentEmail").after('<p class="borderOn lesserColor lineheight30 pBackColor_1" id="resultInfo_p">邮箱格式错误!</p>');return false}var i=d.trim(d("#password").val());if(i==""){d("#currentEmail").after('<p class="borderOn lesserColor lineheight30 pBackColor_1" id="resultInfo_p">请输入密码!</p>');return false}if(i.length<6||i.length>24){d("#currentEmail").after('<p class="borderOn lesserColor lineheight30 pBackColor_1" id="resultInfo_p">密码格式错误!</p>');return false}d("#emailSub").attr("disabled",true);d("#btnReturn").attr("disabled",true);return true};d.mk.register.showUploadLoginEmail=function(){var j=d("#oldEmail").val();var i=d.param({email:j});d.mokoDialog({url:"/jsps/emailactivate/EmailUpdateView.jsp?"+i})};d.mk.register.uploadLoginEmail=function(){var j=d("#oldPwssWord").val();d("#passWordError").hide();d("#newEmailError").hide();if(j.length==0){d("#passWordError").show();d("#passWordError").html("请输入密码！");return}var i=d("#newEmail").val();if(!e.test(i)){d("#newEmailError").show();d("#newEmailError").html("邮箱格式错误!");return}d("#email").val(i);d("#password").val(j);d.ajax({url:"/activateShow|updateLoginEmailAjax.action",type:"post",data:d("#uploadEmailForm").serialize(),success:function(k){if(k=="dataErr"){var l=d.param({content:"数据错误，请刷新页面！"});d.mokoDialog({url:"/jsps/register/RegisterTiShiPop.jsp?"+l})}else{if(k=="pwdError"){d("#passWordError").show();d("#passWordError").html("密码错误！")}else{if(k=="emailError"){d("#newEmailError").show();d("#newEmailError").html("该邮箱已存在！")}else{if(k=="activate"){d.mokoDialog.close();var l=d.param({content:"你的邮箱已激活！"});d.mokoDialog({url:"/jsps/register/RegisterTiShiPop.jsp?"+l})}else{d.mokoDialog.close();var l=d.param({email:i,codeKey:k});d.mokoDialog({url:"/jsps/emailactivate/EmailUpdateOk.jsp?"+l})}}}}}})};d.mk.register.sendEmail=function(){d.ajax({url:"/activateShow|sendActivateEmailAjax.action",type:"post",data:d.param({email:d("#oldEmail").val(),registerId:d("#registerId").val()}),success:function(i){if(i=="success"){var j=d.param({content:"已重新向注册邮箱发送激活邮件！"});d.mokoDialog({url:"/jsps/register/RegisterTiShiPop.jsp?"+j})}else{var j=d.param({content:"数据错误，请刷新页面！"});d.mokoDialog({url:"/jsps/register/RegisterTiShiPop.jsp?"+j})}}})};d.mk.register.goRegisterOk=function(i){d("input:checkbox:checked").prop("checked",false);d.location(i)};_saveVocationListCallBack=function(j){var i="text.update.success";if(j.indexOf(i)!=-1){d.mk.register.unSaveAndBack()}};_checkEmailIsIllegal=function(i){if(i.length<=0){d("#input_email_s").html("请输入登陆邮箱");d("#input_email").show();d("#input_email").attr("class","reg-check-tip wrong");g="F";return false}else{if(!e.test(i)){d("#input_email").show();d("#input_email_s").html("该登陆邮箱格式不对或已使用");d("#input_email").attr("class","reg-check-tip wrong");g="F";return false}}g="T";return true};_validateVerifyCode=function(j){var i=false;if(d.trim(j)==""){d("#verifycodeErrorMsg").html("请输入验证码");d("#input_verifycode").attr("class","reg-check-tip wrong");d("#input_verifycode").show();return false}d.ajax({type:"post",url:"/register|checkValidate.action",data:{j_image_code_response:j},async:false,success:function(k){if(k=="success"){d("#input_verifycode").attr("class","reg-check-tip ok");d("#input_verifycode").show();i=true}else{d.mk.register.changeVerifyCode();d("#verifycodeErrorMsg").html("验证码输入有误,请重新输入!");d("#input_verifycode").attr("class","reg-check-tip wrong");d("#input_verifycode").show();i=false}}});return i}})(jQuery1);