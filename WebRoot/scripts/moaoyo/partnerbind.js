(function(b){if(typeof b.mk=="undefined"){b.mk={}}if(typeof b.mk.bd=="undefined"){b.mk.bd={}}var c=null;b.mk.bd.bindSina=function(d){b.mokoDialog.close();b.mokoDialog({url:"/jsps/partnerbind/sina/SinaPop.jsp?state="+d})};b.mk.bd.bindSinaCallBack=function(e,d){if(!e){alert("关联出错");b.mokoDialog.close();return}if(b("#divBindSina").size()!=0){b("#divBindSina-bind").hide();b("#divBindSina-cancle-accounts-name").html(d);b("#divBindSina-cancle").show()}if(c!=null){c.prop("checked",true)}b.mokoDialog.close()};b.mk.bd.cancleBindSina=function(){b.ajax({url:"/sinaBind|cancleBindAjax.action",type:"get",data:"",success:function(d){if(d=="success"){b("#divBindSina-cancle").hide();b("#sync-sina-weibo").prop("checked",false);c=null;b("#divBindSina-bind").show()}else{alert("数据错误,请刷新页面重新操作！")}}})};b.mk.bd.stateChangeIE=function(d){if(d.readyState=="interactive"){b("#sina-pop-load").hide();b(d).show()}};b.mk.bd.stateChangeFirefox=function(d){b("#sina-pop-load").hide();b(d).show()};b.mk.bd.sinaLoginCallback=function(e,d){if(e==1){b.mokoDialog.close();b.reload()}if(e==2){b.mokoDialog.close();b.location(encodeURI(d))}};var a=null;b.mk.bd.bindQQ=function(d){b.mokoDialog.close();a=window.open(d,"qqOauth2Login","height=525, width=585, top=100, left=200, toolbar=no, menubar=no, scrollbars=no, status=no, location=yes, resizable=yes")};b.mk.bd.qqLoginCallback=function(e,d){a.close();if(e==1){b.reload()}if(e==2){b.location(encodeURI(d))}};b.mk.bd.bindQQCallBack=function(d,e){a.close();if(!d){alert("关联出错");return}if(b("#divBindSina").size()!=0){b("#divBindQQ-bind").hide();b("#divBindQQ-cancle-accounts-name").html(e);b("#divBindQQ-cancle").show()}if(c!=null){c.prop("checked",true)}};b.mk.bd.cancleBindQQ=function(){b.ajax({url:"/qqBind|cancleBindAjax.action",type:"get",data:"",success:function(d){if(d=="success"){b("#divBindQQ-cancle").hide();b("#sync-qzone").prop("checked",false);b("#sync-qq-weibo").prop("checked",false);c=null;b("#divBindQQ-bind").show()}else{alert("数据错误,请刷新页面重新操作！")}}})};b.mk.bd.setConnectInfo=function(){var f=decodeURI(decodeURI(b.getCookie("MOKO_CONNECT_NICKNAMEKEY")));var d=b.getCookie("MOKO_CONNECTKEY");var e="";if(d=="qq"){e="<span>"+f+"</span>&nbsp;&nbsp;欢迎使用QQ帐号访问MOKO!"}if(d=="sina"){e="<span>"+f+"</span>&nbsp;&nbsp;欢迎使用新浪微博帐号访问MOKO!"}b("#connect-accounts-info").html(e);b("#connect-accounts-logo").addClass(d)};b.mk.bd.checkToken=function(e,f){c=b(e);if(!c.prop("checked")){if(f){_cancelSync(c.val())}return false}var d=c.attr("checkurl");if(d==undefined||d==""){return false}tag=true;b.ajax({url:d,type:"get",async:false,success:function(g){if(g!="success"){c.prop("checked",false);_checkTokenFaild(c.val());tag=false}else{if(f){_setSync(c.val())}}}});if(f){c=null}return tag};_checkTokenFaild=function(d){if(d=="W"||d=="Z"){b.mk.bd.bindQQ(b("#syncQQBindUrl").val());return}if(d=="S"){b.mk.bd.bindSina(b("#syncBindType").val());return}};_setSync=function(d){if(d=="W"||d=="Z"){url="/qqBind|setSyncAjax.action"}if(d=="S"){url="/sinaBind|setSyncAjax.action"}b.ajax({url:url,type:"post",data:{syncType:d},success:function(e){}})};_cancelSync=function(d){if(d=="W"||d=="Z"){url="/qqBind|cancelSyncAjax.action"}if(d=="S"){url="/sinaBind|cancelSyncAjax.action"}b.ajax({url:url,type:"post",data:{syncType:d},success:function(e){}})}})(jQuery1);